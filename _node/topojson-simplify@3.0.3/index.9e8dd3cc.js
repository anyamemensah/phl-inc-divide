import{feature as S,transform as T}from"../topojson-client@3.1.0/index.a55369bb.js";function _(n){var r=n.objects,o={},u=n.arcs,f=u.length,a=-1,t=new Array(f),c=0,l,e=-1,i;function p(s){switch(s.type){case"GeometryCollection":s.geometries.forEach(p);break;case"LineString":y(s.arcs);break;case"MultiLineString":s.arcs.forEach(y);break;case"Polygon":s.arcs.forEach(y);break;case"MultiPolygon":s.arcs.forEach(v);break}}function b(s){s<0&&(s=~s),t[s]||(t[s]=1,++c)}function y(s){s.forEach(b)}function v(s){s.forEach(y)}function m(s){var g;switch(s.type){case"GeometryCollection":g={type:"GeometryCollection",geometries:s.geometries.map(m)};break;case"LineString":g={type:"LineString",arcs:h(s.arcs)};break;case"MultiLineString":g={type:"MultiLineString",arcs:s.arcs.map(h)};break;case"Polygon":g={type:"Polygon",arcs:s.arcs.map(h)};break;case"MultiPolygon":g={type:"MultiPolygon",arcs:s.arcs.map(d)};break;default:return s}return s.id!=null&&(g.id=s.id),s.bbox!=null&&(g.bbox=s.bbox),s.properties!=null&&(g.properties=s.properties),g}function k(s){return s<0?~t[~s]:t[s]}function h(s){return s.map(k)}function d(s){return s.map(h)}for(i in r)p(r[i]);for(l=new Array(c);++a<f;)t[a]&&(t[a]=++e,l[e]=u[a]);for(i in r)o[i]=m(r[i]);return{type:"Topology",bbox:n.bbox,transform:n.transform,objects:o,arcs:l}}function N(n,r){var o=n.objects,u={},f;r==null&&(r=I);function a(e){var i,p;switch(e.type){case"Polygon":{p=t(e.arcs),i=p?{type:"Polygon",arcs:p}:{type:null};break}case"MultiPolygon":{p=e.arcs.map(t).filter(q),i=p.length?{type:"MultiPolygon",arcs:p}:{type:null};break}case"GeometryCollection":{p=e.geometries.map(a).filter(R),i=p.length?{type:"GeometryCollection",geometries:p}:{type:null};break}default:return e}return e.id!=null&&(i.id=e.id),e.bbox!=null&&(i.bbox=e.bbox),e.properties!=null&&(i.properties=e.properties),i}function t(e){return e.length&&c(e[0])?[e[0]].concat(e.slice(1).filter(l)):null}function c(e){return r(e,!1)}function l(e){return r(e,!0)}for(f in o)u[f]=a(o[f]);return _({bbox:n.bbox,transform:n.transform,objects:u,arcs:n.arcs})}function I(){return!0}function q(n){return n}function R(n){return n.type!=null}function j(n){var r=new Array(n.arcs.length),o=0,u;function f(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(f);break;case"Polygon":a(t.arcs);break;case"MultiPolygon":t.arcs.forEach(a);break}}function a(t){for(var c=0,l=t.length;c<l;++c,++o)for(var e=t[c],i=0,p=e.length;i<p;++i){var b=e[i];b<0&&(b=~b);var y=r[b];y==null?r[b]=o:y!==o&&(r[b]=-1)}}for(u in n.objects)f(n.objects[u]);return function(t){for(var c=0,l=t.length,e;c<l;++c)if(r[(e=t[c])<0?~e:e]===-1)return!0;return!1}}function w(n){var r=n[0],o=n[1],u=n[2];return Math.abs((r[0]-u[0])*(o[1]-r[1])-(r[0]-o[0])*(u[1]-r[1]))/2}function $(n){for(var r=-1,o=n.length,u,f=n[o-1],a=0;++r<o;)u=f,f=n[r],a+=u[0]*f[1]-u[1]*f[0];return Math.abs(a)/2}function L(n,r,o){return r=r==null?Number.MIN_VALUE:+r,o==null&&(o=$),function(u,f){return o(S(n,{type:"Polygon",arcs:[u]}).geometry.coordinates[0],f)>=r}}function U(n,r,o){var u=j(n),f=L(n,r,o);return function(a,t){return u(a,t)||f(a,t)}}function x(n,r){return n[1][2]-r[1][2]}function V(){var n={},r=[],o=0;n.push=function(a){return u(r[a._=o]=a,o++),o},n.pop=function(){if(!(o<=0)){var a=r[0],t;return--o>0&&(t=r[o],f(r[t._=0]=t,0)),a}},n.remove=function(a){var t=a._,c;if(r[t]===a)return t!==--o&&(c=r[o],(x(c,a)<0?u:f)(r[c._=t]=c,t)),t};function u(a,t){for(;t>0;){var c=(t+1>>1)-1,l=r[c];if(x(a,l)>=0)break;r[l._=t]=l,r[a._=t=c]=a}}function f(a,t){for(;;){var c=t+1<<1,l=c-1,e=t,i=r[e];if(l<o&&x(r[l],i)<0&&(i=r[e=l]),c<o&&x(r[c],i)<0&&(i=r[e=c]),e===t)break;r[i._=t]=i,r[a._=t=e]=a}}return n}function W(n){return[n[0],n[1],0]}function z(n,r){var o=n.transform?T(n.transform):W,u=V();r==null&&(r=w);var f=n.arcs.map(function(t){var c=[],l=0,e,i,p;for(t=t.map(o),i=1,p=t.length-1;i<p;++i)e=[t[i-1],t[i],t[i+1]],e[1][2]=r(e),c.push(e),u.push(e);for(t[0][2]=t[p][2]=1/0,i=0,p=c.length;i<p;++i)e=c[i],e.previous=c[i-1],e.next=c[i+1];for(;e=u.pop();){var b=e.previous,y=e.next;e[1][2]<l?e[1][2]=l:l=e[1][2],b&&(b.next=y,b[2]=e[2],a(b)),y&&(y.previous=b,y[0]=e[0],a(y))}return t});function a(t){u.remove(t),t[1][2]=r(t),u.push(t)}return{type:"Topology",bbox:n.bbox,objects:n.objects,arcs:f}}function F(n,r){var o=[];return n.arcs.forEach(function(u){u.forEach(function(f){isFinite(f[2])&&o.push(f[2])})}),o.length&&B(o.sort(D),r)}function B(n,r){if(o=n.length){if((r=+r)<=0||o<2)return n[0];if(r>=1)return n[o-1];var o,u=(o-1)*r,f=Math.floor(u),a=n[f],t=n[f+1];return a+(t-a)*(u-f)}}function D(n,r){return r-n}function H(n,r){r=r==null?Number.MIN_VALUE:+r;var o=n.arcs.map(function(u){for(var f=-1,a=0,t=u.length,c=new Array(t),l;++f<t;)(l=u[f])[2]>=r&&(c[a++]=[l[0],l[1]]);return c.length=a,c});return{type:"Topology",transform:n.transform,bbox:n.bbox,objects:n.objects,arcs:o}}var A=Math.PI,J=2*A,C=A/4,M=A/180,K=Math.abs,O=Math.atan2,P=Math.cos,E=Math.sin;function G(n,r){for(var o=0,u=n.length,f=0,a=n[r?o++:u-1],t,c=a[0]*M,l=a[1]*M/2+C,e,i=P(l),p,b=E(l);o<u;++o){a=n[o],t=c,c=a[0]*M,l=a[1]*M/2+C,e=i,i=P(l),p=b,b=E(l);var y=c-t,v=y>=0?1:-1,m=v*y,k=p*b,h=e*i+k*P(m),d=k*v*E(m);f+=O(d,h)}return f}function Q(n,r){var o=G(n,!0);return r&&(o*=-1),(o<0?J+o:o)*2}function X(n){return K(G(n,!1))*2}export{N as filter,j as filterAttached,U as filterAttachedWeight,L as filterWeight,$ as planarRingArea,w as planarTriangleArea,z as presimplify,F as quantile,H as simplify,Q as sphericalRingArea,X as sphericalTriangleArea};
